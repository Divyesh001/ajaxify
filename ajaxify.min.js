!function(e,t,n){"use strict";"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n:e.ajaxify=n(e,t)}(this,document,function(e,t,n){"use strict";var r={},o={timeoutTimer:null,s:{},xdr:!1,settings:{accepts:{"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0,method:"GET",timeout:0,url:location.href,username:null,password:null,withCredentials:!1,dataType:"json",data:null,processData:!0,headers:{},crossOrigin:!1,responseType:"",allowedResponseTypes:{"":'""',arraybuffer:"arraybuffer",blob:"blob",document:"document",json:"json",text:"text"}}},s=function(e,t){for(var n in t)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},a=function(){return"FormData"in e?2:1},i=function(e){try{return JSON.parse(e)}catch(t){return[t,e]}},u=function(t,n){try{var r,o=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder;if(o){var s=new o;s.append([t]),r=s.getBlob(n)}else r=new Blob([t],{type:n});return(e.URL||e.webkitURL||e.mozURL||e.msURL).createObjectURL(r)}catch(a){return[a,t]}},c=function(t,r){try{if(e.DOMParser)return(new e.DOMParser).parseFromString(t,r!==n?r:o.s.accepts.xml);var s;return s=new e.ActiveXObject("Microsoft.XMLDOM"),s.async=!1,s.loadXML(t),s}catch(a){return a}},p=function(t,n){try{for(var r=new Uint8Array(t),o=r.length,s=new Array(o);o--;)s[o]=String.fromCharCode(r[o]);return t=s.join(""),"data:"+n+";base64,"+e.btoa(t)}catch(a){return[a,t]}},l=function(e){return"object"==typeof e?s(e,o.settings):o.settings},d=function(e){o.s.contentType!==!1&&e.setRequestHeader("Content-type",o.s.contentType),e.setRequestHeader("Accept",o.s.accepts[o.s.dataType]?o.s.accepts[o.s.dataType]:o.s.accepts["*"]),e.setRequestHeader("X-Requested-With","XMLHttpRequest");for(var t in o.s.headers)o.s.headers.hasOwnProperty(t)&&e.setRequestHeader(t,o.s.headers[t]);return this},f=function(e,t){var n=0;if(Array.isArray(e))Array.prototype.forEach.call(e,t);else for(n in e)if(t.call(e[n],n,e[n])===!1)break;return e},m=function(e){return e&&(e.onload=function(){},e.abort(),e=null),this},y=function(e,t){return t.error.call(t,e),m(e),this},h=function(e){var t=[];if(Array.isArray(e))f(e,function(e,n){t[t.length]=encodeURIComponent(e)+"="+encodeURIComponent(n)});else for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&").replace("/%20/g","+")},T=function(n){var r={done:function(){},error:function(){},always:function(){}};o.s=l(n);var s=new e.XMLHttpRequest||new e.ActiveXObject("MSXML2.XMLHTTP.3.0");"string"!=typeof o.s.data&&o.s.processData===!0&&o.s.data&&"arraybuffer"!==o.s.responseType.toLowerCase()&&"blob"!==o.s.responseType.toLowerCase()&&(o.s.data=h(o.s.data)),o.s.method=o.s.method.toUpperCase()||"GET",o.s.crossOrigin&&("withCredentials"in s||!e.XDomainRequest||(s=new e.XDomainRequest,o.xdr=!0)),"GET"===o.s.method&&(o.s.url=o.s.url+=(/\?/.test(o.s.url)?"&":"?")+(null!==o.s.data?o.s.data:"")+"&time="+(new Date).getTime()),o.xdr===!0?s.open(o.s.method,o.s.url):("withCredentials"in s&&(s.withCredentials=o.s.withCredentials),s.open(o.s.method,o.s.url,o.s.async,o.s.username,o.s.password)),""!==o.s.responseType&&2===a()&&(s.responseType=o.s.allowedResponseTypes[o.s.responseType]?o.s.allowedResponseTypes[o.s.responseType]:""),d(s),o.s.async===!0&&o.s.timeout>0&&(2===a()?s.timeout=o.s.timeout:o.timeoutTimer=e.setTimeout(function(){s.abort("timeout")},o.s.timeout)),s.onload=function(){if(4===s.readyState){if(s.status>=200&&s.status<400){o.timeoutTimer&&e.clearTimeout(o.timeoutTimer);var t;s.response?t=s.response:"text"!==s.responseType&&s.responseType||(t=s.responseText||s.responseXML),r.done.call(r,t,this.getAllResponseHeaders(),this)}else y(s,r);r.always.call(r,s)}},s.ontimeout=function(e){var n=t.getElementsByTagName("body")[0],r=t.createElement("p"),s=t.createTextNode("Loading...");r.appendChild(s),n.appendChild(r),e.target.open(o.s.method,o.s.url),e.target.timeout=o.s.timeout+5e3,e.target.send(o.s.data)},s.onerror=function(){y(s,r)},s.upload.onprogress=function(e){e.lengthComputable&&(t.value=e.loaded/e.total*100,t.textContent=t.value)},o.xdr?(s.onprogress=function(){},s.ontimeout=function(){},s.onerror=function(){},setTimeout(function(){s.send(o.s.data)},4)):s.send(o.s.data);var i={done:function(e){return r.done=e,i},error:function(e){return r.error=e,i},always:function(e){return r.always=e,i}};return i};return r.ajax=function(e){return T(e)},r.each=function(e,t){return f(e,t)},r.parseJSON=function(e){return i(e)},r.parseXML=function(e){return c(e)},r.parseBlob=function(e,t,n,r){return u(e,t,n,r)},r.parseArrayBuffer=function(e,t,n,r){return p(e,t,n,r)},r});
